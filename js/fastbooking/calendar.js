var day_ar=["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"];var month_ar=["Janvier","Fevrier","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Decembre"];var days_month_ar=[31,28,31,30,31,30,31,31,30,31,30,31];var old_mousedown_hdl;var g_day_element,g_month_element,g_year_element;var g_sync_elt;var g_offset_x=4;var g_offset_y=8;function calendarPos(a){this.x=g_offset_x;this.y=g_offset_y;if(a){if(a.offsetParent){this.x+=a.offsetLeft;this.y+=a.offsetTop;while(a=a.offsetParent){this.x+=a.offsetLeft;this.y+=a.offsetTop}}}}function SelElement(a){this.elt=a;this.value=parseInt(a.options[a.selectedIndex].value)}function CalSyncElement(a,b,c){this.day=new SelElement(a);this.month=new SelElement(b);this.year=new SelElement(c)}function getIdProperty(c,b){var a=document.getElementById(c);if(a!=null){a=a.style;if(a[b]){return a[b]}}return null}function setIdProperty(d,c,b){var a=document.getElementById(d);if(a!=null){styleObjectStyle=a.style;if(styleObjectStyle[c]){styleObjectStyle[c]=b}}}function do_show_calendar(){if(getIdProperty("calendar_frame","display")!="block"){setIdProperty("calendar_frame","display","block")}}function do_hide_calendar(){if(getIdProperty("calendar_frame","display")=="block"){setIdProperty("calendar_frame","display","none")}}function show_calendar(a,e,f,g,d,b){g_sync_elt=new CalSyncElement(g,d,b);a_elt=document.getElementById("calendar");if(a_elt!=null){a_point=new calendarPos(f);if(f.width!=undefined){a_point.x=a_point.x+f.width}if(navigator.appVersion.indexOf("MSIE 6")>0){if(e=="home"){setIdProperty("calendar","top","100px");setIdProperty("calendar","left","160px")}else{setIdProperty("calendar","top","32px");setIdProperty("calendar","left","605px")}}else{if(e=="home"){setIdProperty("calendar","top","100px");setIdProperty("calendar","left","660px")}else{setIdProperty("calendar","top","32px");setIdProperty("calendar","left","605px")}}do_show_calendar();build_month_select();var c=document.getElementById("iframe");c.style.width=a_elt.offsetWidth;c.style.height=a_elt.offsetHeight;c.style.left=a_elt.offsetLeft;c.style.top=a_elt.offsetTop;if(document.addEventListener){document.addEventListener("mousedown",track_mouse_down,true)}else{if(document.attachEvent){cal_content=document.getElementById("calendar");cal_content.attachEvent("onmousedown",track_mouse_downie);document.attachEvent("onmousedown",track_hide_calendar)}else{old_mousedown_hdl=document.onmousedown;document.onmousedown=track_mouse_down}}}}function hide_calendar(){do_hide_calendar();if(document.removeEventListener){document.removeEventListener("mousedown",track_mouse_down,true)}else{if(document.detachEvent){cal_content=document.getElementById("calendar");cal_content.detachEvent("onmousedown",track_mouse_downie);document.detachEvent("onmousedown",track_hide_calendar)}else{document.onmousedown=old_mousedown_hdl}}}function track_mouse_down(a){cal_elt=document.getElementById("calendar");tgt=a.target;if(tgt==cal_elt){return}if(tgt.offsetParent){while(tgt=tgt.offsetParent){if(tgt==cal_elt){return}}}hide_calendar()}function track_mouse_downie(a){a.cancelBubble=true}function track_hide_calendar(a){hide_calendar()}function build_month_select(){if(g_sync_elt.month!=undefined){month_val=parseInt(g_sync_elt.month.value);if(month_val<=9){month_str="0"+month_val}else{month_str=String(month_val)}year_val=g_sync_elt.year.value;select_str=month_str+year_val}document.calendar_form.calendar_month.options.length=0;var a=new Date();var c=a.getFullYear();var b=a.getMonth();select_month=b;tot_month=12+(12-b);for(i=0;i<tot_month;i++){label=month_ar[b]+" ";label=label+c;if(b<9){val="0"+(b+1)}else{val=String(b+1)}val=val+c;if(val==select_str){is_selected=true;select_month=b}else{is_selected=false}a_option=new Option(label,val,false,is_selected);document.calendar_form.calendar_month.options[i]=a_option;b++;if(b==12){b=0;c++}}build_days_array(month_val-1,year_val)}function build_days_array(a,b){a_date=new Date(b,a,1,1,1,1);if(((a+1)==g_sync_elt.month.value)&&(b==g_sync_elt.year.value)){can_select=true}else{can_select=false}today=new Date();today_day=today.getDate();today_month=today.getMonth();today_year=today.getFullYear();day_of_week=a_date.getDay();index_day=1;inner_str="<table class='cal_class'><tr>";inner_str=inner_str+build_day_line();inner_str=inner_str+"</tr><tr>";for(i=0;i<7;i++){str="<td class='cal_td'>";if(i<day_of_week){str=str+"&nbsp;"}else{active_day=((b>today_year)||(a>today_month)||(index_day>=today_day))?true:false;if(active_day&&can_select&&(index_day==g_sync_elt.day.value)){style_elt=" style='background-color: #aaaaaa;'"}else{style_elt=""}if(active_day){str=str+"<span class='cal_text'"+style_elt+">";str=str+"<a href='javascript:void(0);' onclick='do_select_day(";str=str+index_day;str=str+")'>";str=str+index_day;str=str+"</a>";str=str+"</span>"}else{str=str+"<span style='text-decoration: line-through'>";str=str+index_day;str=str+"</span>"}index_day++}str=str+"</td>";inner_str=inner_str+str}inner_str=inner_str+"</tr>";do_loop=true;max_day=days_month_ar[a];if((b%4==0)&&(a==1)){max_day++}while(do_loop){inner_str=inner_str+"<tr>";for(i=0;i<7;i++){str="<td class='cal_td'>";if(index_day>max_day){str=str+"&nbsp;"}else{active_day=((b>today_year)||(a>today_month)||(index_day>=today_day))?true:false;if(active_day&&can_select&&(index_day==g_sync_elt.day.value)){style_elt=" style='background-color: #aaaaaa;'"}else{style_elt=""}if(active_day){str=str+"<span class='cal_text'"+style_elt+">";str=str+"<a href='javascript:void(0);' onclick='do_select_day(";str=str+index_day;str=str+")'>";str=str+index_day;str=str+"</a>";str=str+"</span>"}else{str=str+"<span style='text-decoration: line-through'>";str=str+index_day;str=str+"</span>"}index_day++;if(index_day>max_day){do_loop=false}}str=str+"</td>";inner_str=inner_str+str}inner_str=inner_str+"</tr>"}inner_str=inner_str+"</table>";daynums_elt=document.getElementById("cal_days");daynums_elt.innerHTML=inner_str}function build_day_line(){var b="";var a=day_ar.length;for(i=0;i<a;i++){b=b+"<td class='cal_td'>";b=b+day_ar[i];b=b+"</td>"}return b}function do_month_change(){var a=document.calendar_form.calendar_month.value;a_month=parseInt(a.substr(0,2),10);a_year=parseInt(a.substr(2,4),10);build_days_array(a_month-1,a_year)}function do_next_month(){var a=document.calendar_form.calendar_month.selectedIndex;if(a<(document.calendar_form.calendar_month.options.length-1)){document.calendar_form.calendar_month.selectedIndex=++a;do_month_change()}}function do_prev_month(){var a=document.calendar_form.calendar_month.selectedIndex;if(a>0){document.calendar_form.calendar_month.selectedIndex=--a;do_month_change()}}function do_select_day(a){var b=document.calendar_form.calendar_month.value;a_month=parseInt(b.substr(0,2),10);a_year=parseInt(b.substr(2,4),10);if(g_sync_elt.month!=undefined){g_sync_elt.day.elt.value=a;g_sync_elt.month.elt.value=a_month;g_sync_elt.year.elt.value=a_year}hide_calendar()}var objs_list=new Object();var g_offset_x=32;var g_offset_y=-16;function calcPos(a){this.x=g_offset_x;this.y=g_offset_y;if(a){if(a.offsetParent){this.x+=a.offsetLeft;this.y+=a.offsetTop;while(a=a.offsetParent){this.x+=a.offsetLeft;this.y+=a.offsetTop}}}}function getIdProperty(c,b){var a=document.getElementById(c);if(a!=null){a=a.style;if(a[b]){return a[b]}}return null}function setIdProperty(d,c,b){var a=document.getElementById(d);if(a!=null){styleObjectStyle=a.style;if(styleObjectStyle[c]){styleObjectStyle[c]=b}}}function doShowCalc(){if(getIdProperty("calc","display")!="block"){setIdProperty("calc","display","block")}}function doHideCalc(){if(getIdProperty("calc","display")=="block"){setIdProperty("calc","display","none")}}function show_text(b,d,a,c){a_point=new calcPos(d);delta_y=a_point.y;setIdProperty("calc","top",delta_y+"px");delta_x=a_point.x;delta_x+=d.clientWidth;setIdProperty("calc","left",delta_x+"px");if(c!=undefined){obj=document.getElementById("calc");obj.className=c}doShowCalc();document.getElementById("calc").innerHTML=a}function hide_text(){doHideCalc()}arrVille=new Array(3);arrVille[1]=new Array("FRPHCHTLSTLouvre***Best Western Premier Louvre Saint Honore","FRPHCHTLDDBourgogne***Best Western aux Ducs de Bourgogne","FRPHCHTLFEurope***Best Western France Europe","FRPHCHTLODiamond***Best Western Premier Opera Diamond","FRPHCHTLMarigny***Hotel Opera Marigny","FRPHCHTLOpal***Best Western Premier Opal","FRPHCHTLChamps***Hotel des Champs Elysees","FRPHCHTLMathis***Hotel Mathis Elysees","SVFRHTLEPark***Hotel Elysee Park","FRPHCHTLDeneuville***Hotel de Neuville","FRPMercedes***Hotel Mercedes","FRPHCHTLBretagne***Best Western Bretagne Montparnasse","FRPHCHTLBretagne***Hotel Sevres Montparnasse","FRPHCHTLAurore***Hotel Best Western Aurore","FRPHCHTLGDLyon***Paris Hotel Gare de Lyon","FRPHCHTLTonic***Hotel Alexandrie","FRPHCHTLEiffel***Hotel Eiffel Kennedy","FRPHCHTLStlouis***Best Western St Louis");arrVille[2]=new Array("FRPHCHTLSTLouvre***Hotel Media Garden","FRPHCHTLSTLouvre***Restaurant Media Garden");arrVille[3]=new Array("FRPHCHTLStlouis***Quality Centre Del Moon","FRPHCHTLStlouis***Comfort Centre Del Moon");function ChangeHotel(){var b=0;var f=new RegExp("[***]+","g");b=document.idForm.ville.selectedIndex;tailleArr=arrVille[b].length;if(b==0){document.idForm.HotelList.options[0]=new Option("Selectionnez votre hotel",0,true,true);document.idForm.HotelList.length=1}if((navigator.appVersion.indexOf("MSIE 3")<=0)&&(arrVille[b])){for(var e=0;e<arrVille[b].length;e++){var a=arrVille[b][e];var d=a.split(f);var c=new Option(d[1],d[0],false,false);document.idForm.HotelList.options[e]=c}document.idForm.HotelList.length=tailleArr}};